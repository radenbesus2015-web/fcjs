(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,994179,e=>{"use strict";var a=e.i(843476),r=e.i(225913),t=e.i(647163);let s=(0,r.cva)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function n({className:e,variant:r,...n}){return(0,a.jsx)("div",{className:(0,t.cn)(s({variant:r}),e),...n})}e.s(["Badge",()=>n])},23750,10708,e=>{"use strict";var a=e.i(843476),r=e.i(271645),t=e.i(647163);let s=r.forwardRef(({className:e,type:r,...s},n)=>(0,a.jsx)("input",{type:r,className:(0,t.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:n,...s}));s.displayName="Input",e.s(["Input",()=>s],23750);let n=r.forwardRef(({className:e,...r},s)=>(0,a.jsx)("label",{ref:s,className:(0,t.cn)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",e),...r}));n.displayName="Label",e.s(["Label",()=>n],10708)},970065,e=>{"use strict";var a=e.i(843476),r=e.i(271645),t=e.i(647163);let s=r.forwardRef(({className:e,...r},s)=>(0,a.jsx)("div",{ref:s,className:(0,t.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...r}));s.displayName="Card";let n=r.forwardRef(({className:e,...r},s)=>(0,a.jsx)("div",{ref:s,className:(0,t.cn)("flex flex-col space-y-1.5 p-6",e),...r}));n.displayName="CardHeader";let i=r.forwardRef(({className:e,...r},s)=>(0,a.jsx)("h3",{ref:s,className:(0,t.cn)("text-2xl font-semibold leading-none tracking-tight",e),...r}));i.displayName="CardTitle";let d=r.forwardRef(({className:e,...r},s)=>(0,a.jsx)("p",{ref:s,className:(0,t.cn)("text-sm text-muted-foreground",e),...r}));d.displayName="CardDescription";let l=r.forwardRef(({className:e,...r},s)=>(0,a.jsx)("div",{ref:s,className:(0,t.cn)("p-6 pt-0",e),...r}));l.displayName="CardContent",r.forwardRef(({className:e,...r},s)=>(0,a.jsx)("div",{ref:s,className:(0,t.cn)("flex items-center p-6 pt-0",e),...r})).displayName="CardFooter",e.s(["Card",()=>s,"CardContent",()=>l,"CardDescription",()=>d,"CardHeader",()=>n,"CardTitle",()=>i])},269035,e=>{"use strict";var a=e.i(843476),r=e.i(271645),t=e.i(248425),s="horizontal",n=["horizontal","vertical"],i=r.forwardRef((e,r)=>{var i;let{decorative:d,orientation:l=s,...o}=e,c=(i=l,n.includes(i))?l:s;return(0,a.jsx)(t.Primitive.div,{"data-orientation":c,...d?{role:"none"}:{"aria-orientation":"vertical"===c?c:void 0,role:"separator"},...o,ref:r})});i.displayName="Separator";var d=e.i(647163);let l=r.forwardRef(({className:e,orientation:r="horizontal",decorative:t=!0,...s},n)=>(0,a.jsx)(i,{ref:n,decorative:t,orientation:r,className:(0,d.cn)("shrink-0 bg-border","horizontal"===r?"h-[1px] w-full":"h-full w-[1px]",e),...s}));l.displayName=i.displayName,e.s(["Separator",()=>l],269035)},225913,e=>{"use strict";var a=e.i(207670);let r=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,t=a.clsx;e.s(["cva",0,(e,a)=>s=>{var n;if((null==a?void 0:a.variants)==null)return t(e,null==s?void 0:s.class,null==s?void 0:s.className);let{variants:i,defaultVariants:d}=a,l=Object.keys(i).map(e=>{let a=null==s?void 0:s[e],t=null==d?void 0:d[e];if(null===a)return null;let n=r(a)||r(t);return i[e][n]}),o=s&&Object.entries(s).reduce((e,a)=>{let[r,t]=a;return void 0===t||(e[r]=t),e},{});return t(e,l,null==a||null==(n=a.compoundVariants)?void 0:n.reduce((e,a)=>{let{class:r,className:t,...s}=a;return Object.entries(s).every(e=>{let[a,r]=e;return Array.isArray(r)?r.includes({...d,...o}[a]):({...d,...o})[a]===r})?[...e,r,t]:e},[]),null==s?void 0:s.class,null==s?void 0:s.className)}])},920383,e=>{"use strict";var a=e.i(843476),r=e.i(271645),t=e.i(469701),s=e.i(977324),n=e.i(394315),i=e.i(554858),d=e.i(644075),l=e.i(70051),o=e.i(167881),c=e.i(970065),m=e.i(23750),u=e.i(10708),p=e.i(269035),h=e.i(994179);function x(){let{t:e}=(0,t.useI18n)(),{user:x,setUser:b}=(0,s.useAuth)(),f=(0,n.useConfirmDialog)(),[g,y]=(0,r.useState)(!0),[v,j]=(0,r.useState)(""),[N,k]=(0,r.useState)(""),[D,w]=(0,r.useState)({users:0,labels:0,attendance_events:0}),[C,K]=(0,r.useState)({}),[S,A]=(0,r.useState)(null),[I,P]=(0,r.useState)(!1),[R,T]=(0,r.useState)(!1),[_,B]=(0,r.useState)(!1),M=(0,r.useMemo)(()=>[{label:e("adminDashboard.stats.users.label","Users"),value:D.users,caption:e("adminDashboard.stats.users.caption","Registered accounts")},{label:e("adminDashboard.stats.faces.label","Known Faces"),value:D.labels,caption:e("adminDashboard.stats.faces.caption","Embeddings in memory")},{label:e("adminDashboard.stats.attendance.label","Attendance Events"),value:D.attendance_events,caption:e("adminDashboard.stats.attendance.caption","Total log entries")}],[D,e]),L=(0,r.useMemo)(()=>{let a=S?.api_key||"";if(!a)return e("adminDashboard.apiKey.empty","Belum ada API key");if(I)return a;if(a.length<=4)return"•".repeat(Math.max(4,a.length));let r=a.slice(-4);return`${"•".repeat(Math.max(4,a.length-4))}${r}`},[S?.api_key,I,e]);async function O(){y(!0),j("");try{let e=await (0,i.request)("/admin/dashboard-data");k(e.generated_at||""),w(e.stats||{users:0,labels:0,attendance_events:0}),K(e.model_summary||{}),A(e.current_user||null),e.current_user||P(!1)}catch(a){console.error(a),j(e("adminDashboard.error.generic","Gagal memuat dashboard."))}finally{y(!1)}}async function z(){try{await (0,i.request)("/admin/actions/reload-model",{method:"POST",body:{}}),d.toast.success(e("adminDashboard.toast.modelReloaded","Model berhasil dimuat ulang.")),await O()}catch(a){console.error(a),d.toast.error(e("adminDashboard.error.generic","Gagal memuat dashboard."))}}async function E(){if(await f({title:e("adminDashboard.confirm.reloadServerTitle","Muat ulang server?"),description:e("adminDashboard.confirm.reloadServer","Memuat ulang server akan menerapkan ulang konfigurasi. Lanjutkan?"),confirmText:e("adminDashboard.confirm.reloadAction","Muat ulang"),cancelText:e("common.cancel","Batal")}))try{await (0,i.request)("/admin/actions/reload-server",{method:"POST",body:{}}),d.toast.success(e("adminDashboard.toast.serverReloaded","Server dimuat ulang.")),await O()}catch(a){console.error(a),d.toast.error(e("adminDashboard.error.generic","Gagal memuat dashboard."))}}async function G(){let a=S?.api_key||"";if(!a)return void d.toast.error(e("adminDashboard.apiKey.notAvailable","API key tidak tersedia."));T(!0);try{await navigator.clipboard.writeText(a),d.toast.success(e("adminDashboard.apiKey.copied","API key disalin ke clipboard."))}catch{d.toast.error(e("adminDashboard.apiKey.copyError","Gagal menyalin API key."))}finally{T(!1)}}async function U(){if(S?.id&&await f({title:e("confirm.rotateKeyTitle","Putar API key?"),description:e("confirm.rotateKey","Generate API key baru untuk akun kamu? Kamu harus memperbarui token header setelah ini."),confirmText:e("confirm.rotateAction","Generate"),cancelText:e("common.cancel","Batal")})){B(!0);try{let a=await (0,i.request)(`/admin/users/${encodeURIComponent(S.id)}/api-key`,{method:"POST",body:{}});if(d.toast.success(e("adminDashboard.toast.apiKeyRotated","API key diperbarui.")),await O(),a?.user?.api_key)try{localStorage.setItem("fm_token",a.user.api_key)}catch{}}catch(a){console.error(a),d.toast.error(e("adminDashboard.error.rotateKey","Gagal memutar API key."))}finally{B(!1)}}}return((0,r.useEffect)(()=>{O()},[]),g)?(0,a.jsx)(c.Card,{children:(0,a.jsx)(c.CardContent,{className:"py-12 text-center text-sm text-muted-foreground",children:e("adminDashboard.state.loading","Memuat dashboard…")})}):v?(0,a.jsx)(c.Card,{className:"border-rose-300/60",children:(0,a.jsx)(c.CardContent,{className:"py-6 text-center text-sm text-rose-600",children:v})}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs tracking-widest text-muted-foreground uppercase",children:e("adminDashboard.breadcrumb","Admin Console")}),(0,a.jsxs)("div",{className:"flex flex-col gap-2 lg:flex-row lg:items-center lg:justify-between",children:[(0,a.jsx)("div",{children:(0,a.jsx)(c.CardTitle,{className:"text-2xl",children:e("adminDashboard.greeting","Hello, {name}",{name:S?.username||e("adminDashboard.fallbackName","Admin")})})}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,a.jsxs)(o.Button,{variant:"outline",onClick:z,children:[(0,a.jsx)(l.Icon,{name:"RotateCw",className:"mr-2 h-4 w-4"}),e("adminDashboard.actions.reloadModel","Reload Model")]}),(0,a.jsxs)(o.Button,{onClick:E,children:[(0,a.jsx)(l.Icon,{name:"Rocket",className:"mr-2 h-4 w-4"}),e("adminDashboard.actions.reloadServer","Reload Server")]})]})]})]}),(0,a.jsx)("div",{className:"grid gap-4 sm:grid-cols-3",children:M.map(e=>(0,a.jsx)(c.Card,{children:(0,a.jsxs)(c.CardContent,{className:"p-4",children:[(0,a.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-muted-foreground",children:e.label}),(0,a.jsx)("p",{className:"mt-2 text-3xl font-semibold",children:e.value}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:e.caption})]})},e.label))}),S&&(0,a.jsxs)(c.Card,{children:[(0,a.jsxs)(c.CardHeader,{className:"pb-2",children:[(0,a.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-muted-foreground",children:e("adminDashboard.apiKey.title","YOUR API KEY")}),(0,a.jsx)(c.CardTitle,{className:"text-base",children:e("adminDashboard.apiKey.subtitle","Kredensial pribadi")})]}),(0,a.jsx)(c.CardContent,{className:"flex flex-col gap-3 sm:flex-row sm:items-center",children:(0,a.jsxs)("div",{className:"space-y-2 w-full sm:w-auto",children:[(0,a.jsx)(u.Label,{className:"sr-only",children:"API Key"}),(0,a.jsxs)("div",{className:"flex flex-wrap sm:flex-nowrap gap-2",children:[(0,a.jsx)(m.Input,{value:L,readOnly:!0,className:"font-mono font-semibold tracking-wide"}),(0,a.jsx)(o.Button,{variant:"outline",size:"sm",onClick:()=>P(e=>!e),children:I?e("adminDashboard.apiKey.hide","Sembunyikan"):e("adminDashboard.apiKey.show","Tampilkan")}),(0,a.jsx)(o.Button,{variant:"outline",size:"sm",className:"whitespace-nowrap",disabled:R,onClick:G,"aria-label":e("adminDashboard.apiKey.copy","Salin API Key"),children:R?e("adminDashboard.apiKey.copying","Menyalin…"):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:"sm:hidden",children:e("adminDashboard.apiKey.copyShort","Salin")}),(0,a.jsx)("span",{className:"hidden sm:inline",children:e("adminDashboard.apiKey.copy","Salin API Key")})]})}),(0,a.jsx)(o.Button,{size:"sm",className:"whitespace-nowrap",disabled:_,onClick:U,"aria-label":e("adminDashboard.actions.rotateKey","Putar API Key"),children:_?e("adminDashboard.actions.processing","Memproses…"):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:"sm:hidden",children:e("adminDashboard.actions.rotateShort","Putar")}),(0,a.jsx)("span",{className:"hidden sm:inline",children:e("adminDashboard.actions.rotateKey","Putar API Key")})]})})]}),(0,a.jsx)("p",{className:"text-[11px] text-muted-foreground",children:e("adminDashboard.apiKey.hint","Send via Authorization header: Bearer <API_KEY>")})]})})]}),(0,a.jsxs)(c.Card,{children:[(0,a.jsx)(c.CardHeader,{className:"flex flex-row items-center justify-between space-y-0",children:(0,a.jsx)(c.CardTitle,{className:"text-lg",children:e("adminDashboard.model.title","Active Model")})}),(0,a.jsx)(p.Separator,{}),(0,a.jsxs)(c.CardContent,{className:"space-y-6 text-sm p-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-muted-foreground",children:e("adminDashboard.model.backendLabel","Backend")}),(0,a.jsx)("p",{className:"font-semibold uppercase",children:C.backend||e("adminDashboard.model.unknown","UNKNOWN")}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:e("adminDashboard.model.backendMeta","Backend {backendId} • target {targetId}",{backendId:C.backend_id??"—",targetId:C.target_id??"—"})})]}),(0,a.jsx)(p.Separator,{}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-muted-foreground",children:e("adminDashboard.model.emotionLabel","Emotion Model")}),(0,a.jsx)("p",{className:"font-semibold",children:C.emotion_model||e("adminDashboard.model.none","None")}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:e("adminDashboard.model.emotionCount","Labels: {count}",{count:(C.emotion_labels||[]).length})}),(0,a.jsx)("div",{className:"mt-2 flex flex-wrap gap-2",children:(C.emotion_labels||[]).length>0?(C.emotion_labels||[]).map(e=>(0,a.jsx)(h.Badge,{children:e},e)):(0,a.jsx)(h.Badge,{children:e("adminDashboard.model.noEmotionLabels","Tidak ada label emosi")})})]}),(0,a.jsx)(p.Separator,{}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-[0.2em] text-muted-foreground",children:e("adminDashboard.model.registeredLabels","Registered Labels")}),(0,a.jsx)("div",{className:"mt-2 flex flex-wrap gap-2",children:(C.labels||[]).length>0?(C.labels||[]).map(e=>(0,a.jsx)(h.Badge,{children:e},e)):(0,a.jsx)(h.Badge,{children:e("adminDashboard.model.noLabels","Tidak ada label")})})]})]})]})]})}e.s(["default",()=>x])}]);