(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,970065,e=>{"use strict";var a=e.i(843476),t=e.i(271645),n=e.i(647163);let s=t.forwardRef(({className:e,...t},s)=>(0,a.jsx)("div",{ref:s,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));s.displayName="Card";let i=t.forwardRef(({className:e,...t},s)=>(0,a.jsx)("div",{ref:s,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",e),...t}));i.displayName="CardHeader";let r=t.forwardRef(({className:e,...t},s)=>(0,a.jsx)("h3",{ref:s,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",e),...t}));r.displayName="CardTitle";let l=t.forwardRef(({className:e,...t},s)=>(0,a.jsx)("p",{ref:s,className:(0,n.cn)("text-sm text-muted-foreground",e),...t}));l.displayName="CardDescription";let o=t.forwardRef(({className:e,...t},s)=>(0,a.jsx)("div",{ref:s,className:(0,n.cn)("p-6 pt-0",e),...t}));o.displayName="CardContent",t.forwardRef(({className:e,...t},s)=>(0,a.jsx)("div",{ref:s,className:(0,n.cn)("flex items-center p-6 pt-0",e),...t})).displayName="CardFooter",e.s(["Card",()=>s,"CardContent",()=>o,"CardDescription",()=>l,"CardHeader",()=>i,"CardTitle",()=>r])},269035,e=>{"use strict";var a=e.i(843476),t=e.i(271645),n=e.i(248425),s="horizontal",i=["horizontal","vertical"],r=t.forwardRef((e,t)=>{var r;let{decorative:l,orientation:o=s,...d}=e,c=(r=o,i.includes(r))?o:s;return(0,a.jsx)(n.Primitive.div,{"data-orientation":c,...l?{role:"none"}:{"aria-orientation":"vertical"===c?c:void 0,role:"separator"},...d,ref:t})});r.displayName="Separator";var l=e.i(647163);let o=t.forwardRef(({className:e,orientation:t="horizontal",decorative:n=!0,...s},i)=>(0,a.jsx)(r,{ref:i,decorative:n,orientation:t,className:(0,l.cn)("shrink-0 bg-border","horizontal"===t?"h-[1px] w-full":"h-full w-[1px]",e),...s}));o.displayName=r.displayName,e.s(["Separator",()=>o],269035)},225913,e=>{"use strict";var a=e.i(207670);let t=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,n=a.clsx;e.s(["cva",0,(e,a)=>s=>{var i;if((null==a?void 0:a.variants)==null)return n(e,null==s?void 0:s.class,null==s?void 0:s.className);let{variants:r,defaultVariants:l}=a,o=Object.keys(r).map(e=>{let a=null==s?void 0:s[e],n=null==l?void 0:l[e];if(null===a)return null;let i=t(a)||t(n);return r[e][i]}),d=s&&Object.entries(s).reduce((e,a)=>{let[t,n]=a;return void 0===n||(e[t]=n),e},{});return n(e,o,null==a||null==(i=a.compoundVariants)?void 0:i.reduce((e,a)=>{let{class:t,className:n,...s}=a;return Object.entries(s).every(e=>{let[a,t]=e;return Array.isArray(t)?t.includes({...l,...d}[a]):({...l,...d})[a]===t})?[...e,t,n]:e},[]),null==s?void 0:s.class,null==s?void 0:s.className)}])},23750,10708,e=>{"use strict";var a=e.i(843476),t=e.i(271645),n=e.i(647163);let s=t.forwardRef(({className:e,type:t,...s},i)=>(0,a.jsx)("input",{type:t,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:i,...s}));s.displayName="Input",e.s(["Input",()=>s],23750);let i=t.forwardRef(({className:e,...t},s)=>(0,a.jsx)("label",{ref:s,className:(0,n.cn)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",e),...t}));i.displayName="Label",e.s(["Label",()=>i],10708)},630374,e=>{"use strict";var a=e.i(843476),t=e.i(271645),n=e.i(326999),s=e.i(841947),s=s,i=e.i(647163);let r=n.Root;n.Trigger;let l=n.Portal;n.Close;let o=t.forwardRef(({className:e,...t},s)=>(0,a.jsx)(n.Overlay,{ref:s,className:(0,i.cn)("fixed inset-0 z-50 bg-background/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));o.displayName=n.Overlay.displayName;let d=t.forwardRef(({className:e,children:t,overlayClassName:r,hideOverlay:d,...c},u)=>(0,a.jsxs)(l,{children:[!d&&(0,a.jsx)(o,{className:r}),(0,a.jsxs)(n.Content,{ref:u,className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...c,children:[t,(0,a.jsxs)(n.Close,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(s.default,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]}));d.displayName=n.Content.displayName;let c=({className:e,...t})=>(0,a.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});c.displayName="DialogHeader";let u=({className:e,...t})=>(0,a.jsx)("div",{className:(0,i.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});u.displayName="DialogFooter";let m=t.forwardRef(({className:e,...t},s)=>(0,a.jsx)(n.Title,{ref:s,className:(0,i.cn)("text-lg font-semibold leading-none tracking-tight",e),...t}));m.displayName=n.Title.displayName;let f=t.forwardRef(({className:e,...t},s)=>(0,a.jsx)(n.Description,{ref:s,className:(0,i.cn)("text-sm text-muted-foreground",e),...t}));f.displayName=n.Description.displayName,e.s(["Dialog",()=>r,"DialogContent",()=>d,"DialogDescription",()=>f,"DialogFooter",()=>u,"DialogHeader",()=>c,"DialogTitle",()=>m],630374)},781947,e=>{"use strict";var a=e.i(843476),t=e.i(271645),n=e.i(225913),s=e.i(647163);let i=(0,n.cva)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),r=t.forwardRef(({className:e,variant:t,...n},r)=>(0,a.jsx)("div",{ref:r,role:"alert",className:(0,s.cn)(i({variant:t}),e),...n}));r.displayName="Alert";let l=t.forwardRef(({className:e,...t},n)=>(0,a.jsx)("h5",{ref:n,className:(0,s.cn)("mb-1 font-medium leading-none tracking-tight",e),...t}));l.displayName="AlertTitle";let o=t.forwardRef(({className:e,...t},n)=>(0,a.jsx)("div",{ref:n,className:(0,s.cn)("text-sm [&_p]:leading-relaxed",e),...t}));o.displayName="AlertDescription",e.s(["Alert",()=>r,"AlertDescription",()=>o,"AlertTitle",()=>l])},413467,e=>{"use strict";var a=e.i(843476),t=e.i(271645),n=e.i(469701),s=e.i(977324),i=e.i(394315),r=e.i(554858),l=e.i(644075),o=e.i(167881),d=e.i(970065),c=e.i(23750),u=e.i(10708),m=e.i(269035),f=e.i(781947),g=e.i(630374);function p(){let{t:e,locale:p}=(0,n.useI18n)(),{user:x,setUser:h}=(0,s.useAuth)(),_=(0,i.useConfirmDialog)(),[v,b]=(0,t.useState)({loading:!0,error:"",config:{face_engine:{},attendance:{}},defaults:{face_engine:{},attendance:{}}}),[N,y]=(0,t.useState)(!1),[j,C]=(0,t.useState)({open:!1,title:"",content:""}),[w,k]=(0,t.useState)({min_cosine_accept:"",fun_ws_min_interval:"",att_ws_min_interval:"",yunet_score_threshold:"",yunet_nms_threshold:"",yunet_top_k:""}),[D,A]=(0,t.useState)({cooldown_str:"",min_cosine_accept:""}),S=e=>null==e?"":String(e),T=(0,t.useCallback)(()=>{let e=v.config?.face_engine||{};k({min_cosine_accept:S(e.min_cosine_accept),fun_ws_min_interval:S(e.fun_ws_min_interval),att_ws_min_interval:S(e.att_ws_min_interval),yunet_score_threshold:S(e.yunet_score_threshold),yunet_nms_threshold:S(e.yunet_nms_threshold),yunet_top_k:S(e.yunet_top_k)});let a=v.config?.attendance||{};A({cooldown_str:(e=>{let a=Number(e);if(Number.isFinite(a)&&a>=0){let e=Math.floor(a/60),t=Math.max(0,Math.round(a%60));return`${e}:${String(t).padStart(2,"0")}`}let t=String(e||"").trim();if(!t)return"";if(/^\d{1,}:[0-5]\d$/.test(t))return t;let n=Number(t);if(Number.isFinite(n)&&n>=0){let e=Math.floor(n/60),a=Math.max(0,Math.round(n%60));return`${e}:${String(a).padStart(2,"0")}`}return t})(a.cooldown_sec),min_cosine_accept:S(a.min_cosine_accept)})},[v.config]),R=(0,t.useCallback)(async()=>{b(e=>({...e,loading:!0,error:""}));try{let e=await (0,r.request)("/admin/dashboard-data",{method:"GET"}),a=e?.config||{face_engine:{},attendance:{}},t=e?.config_defaults||{face_engine:{},attendance:{}};b({loading:!1,error:"",config:a,defaults:t})}catch(a){b(t=>({...t,loading:!1,error:a?.message||e("adminConfig.error.fetch","Gagal memuat konfigurasi.")}))}},[e,x]);(0,t.useEffect)(()=>{R()},[R]),(0,t.useEffect)(()=>{v.loading||T()},[v.loading,T]);let I=async a=>{try{let t=(a=>{if("face_engine"===a){let a={},t=(t,n)=>{if(""===n||null==n)return;let s=Number(n);if(Number.isNaN(s))throw Error(e("adminConfig.errors.mustNumber","{field} harus berupa angka.",{field:String(t)}));a[t]=s};return(t("min_cosine_accept",w.min_cosine_accept),t("fun_ws_min_interval",w.fun_ws_min_interval),t("att_ws_min_interval",w.att_ws_min_interval),t("yunet_score_threshold",w.yunet_score_threshold),t("yunet_nms_threshold",w.yunet_nms_threshold),t("yunet_top_k",w.yunet_top_k),0===Object.keys(a).length)?null:{face_engine:a}}if("attendance"===a){let a={},t=String(D.cooldown_str??"").trim();if(""!==t){let n=(a=>{let t=String(a??"").trim();if(!t)return null;if(/^\d{1,}:[0-5]\d$/.test(t)){let[e,a]=t.split(":");return Math.max(0,60*Number(e)+Number(a))}let n=Number(t);if(Number.isFinite(n)&&n>=0)return Math.round(n);throw Error(e("adminConfig.errors.mustDuration","Cooldown harus berupa mm:ss atau jumlah detik."))})(t);null!==n&&(a.cooldown_sec=n)}if(""!==D.min_cosine_accept){let t=Number(D.min_cosine_accept);if(Number.isNaN(t))throw Error(e("adminConfig.errors.mustNumber","{field} harus berupa angka.",{field:"min_cosine_accept"}));a.min_cosine_accept=t}return 0===Object.keys(a).length?null:{attendance:a}}return null})(a);if(!t)return void l.toast.info(e("adminConfig.toast.noChanges","Tidak ada perubahan untuk disimpan."));y(!0),await (0,r.request)("/config",{method:"PUT",body:t}),l.toast.success(e("adminConfig.toast.saved","Konfigurasi disimpan.")),await R()}catch(a){l.toast.error(a?.message||e("adminConfig.error.generic","Gagal menyimpan konfigurasi."))}finally{y(!1)}},E=async a=>{let t="face_engine"===a?e("adminConfig.reset.scopeFace","konfigurasi face engine"):"attendance"===a?e("adminConfig.reset.scopeAttendance","konfigurasi attendance"):e("adminConfig.reset.scopeAll","semua konfigurasi");if(await _({title:e("adminConfig.reset.title","Konfirmasi Reset"),description:e("adminConfig.reset.confirm","Atur ulang {scope}?",{scope:t}),confirmText:e("adminConfig.reset.ok","Atur ulang"),cancelText:e("common.cancel","Batal")}))try{await (0,r.request)("/config/reset",{method:"POST",body:{scope:a}}),l.toast.success(e("adminConfig.toast.reset","Konfigurasi direset.")),await R()}catch(a){l.toast.error(a?.message||e("adminConfig.error.generic","Gagal menyimpan konfigurasi."))}};return(0,a.jsxs)("div",{className:"space-y-6",children:[v.error&&(0,a.jsxs)(f.Alert,{variant:"destructive",children:[(0,a.jsx)(f.AlertTitle,{children:e("adminConfig.error.title","Terjadi kesalahan")}),(0,a.jsx)(f.AlertDescription,{children:v.error})]}),v.loading&&(0,a.jsx)("div",{className:"rounded-md border border-dashed p-3 text-sm text-muted-foreground",children:e("state.loading","Memuat data config...")}),!v.loading&&(0,a.jsxs)(d.Card,{children:[(0,a.jsxs)(d.CardHeader,{className:"flex sm:flex-row sm:justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(d.CardTitle,{children:e("adminConfig.sections.faceEngine.title","Face Engine")}),(0,a.jsx)(d.CardDescription,{children:e("adminConfig.sections.faceEngine.subtitle","Atur interval WS dan ambang deteksi YuNet.")})]}),(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,a.jsx)(o.Button,{variant:"outline",size:"sm",onClick:()=>E("face_engine"),children:e("adminConfig.actions.resetFace","Atur Ulang Face Engine")}),(0,a.jsx)(o.Button,{variant:"outline",size:"sm",onClick:()=>E("attendance"),children:e("adminConfig.actions.resetAttendance","Atur Ulang Absensi")}),(0,a.jsx)(o.Button,{variant:"destructive",size:"sm",onClick:()=>E("all"),children:e("adminConfig.actions.resetAll","Atur Ulang Semua")})]})]}),(0,a.jsx)(m.Separator,{}),(0,a.jsx)(d.CardContent,{className:"p-6 space-y-6",children:(0,a.jsxs)("form",{className:"grid gap-4 sm:grid-cols-2",onSubmit:e=>{e.preventDefault(),I("face_engine")},children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)(u.Label,{className:"text-xs font-semibold",children:e("adminConfig.fields.minCosine","Ambang Cosine Minimum")}),(0,a.jsx)(c.Input,{value:w.min_cosine_accept,onChange:e=>k(a=>({...a,min_cosine_accept:e.target.value}))}),(0,a.jsx)("p",{className:"text-[11px] text-muted-foreground",children:e("adminConfig.defaults.value","Default: {value}",{value:v.defaults.face_engine?.min_cosine_accept??"—"})})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)(u.Label,{className:"text-xs font-semibold",children:e("adminConfig.fields.funInterval","Interval WS Fun (detik)")}),(0,a.jsx)(c.Input,{value:w.fun_ws_min_interval,onChange:e=>k(a=>({...a,fun_ws_min_interval:e.target.value}))}),(0,a.jsx)("p",{className:"text-[11px] text-muted-foreground",children:e("adminConfig.defaults.value","Default: {value}",{value:v.defaults.face_engine?.fun_ws_min_interval??"—"})})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)(u.Label,{className:"text-xs font-semibold",children:e("adminConfig.fields.attInterval","Interval WS Attendance (detik)")}),(0,a.jsx)(c.Input,{value:w.att_ws_min_interval,onChange:e=>k(a=>({...a,att_ws_min_interval:e.target.value}))}),(0,a.jsx)("p",{className:"text-[11px] text-muted-foreground",children:e("adminConfig.defaults.value","Default: {value}",{value:v.defaults.face_engine?.att_ws_min_interval??"—"})})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)(u.Label,{className:"text-xs font-semibold",children:e("adminConfig.fields.scoreThreshold","Ambang Skor YuNet")}),(0,a.jsx)(c.Input,{value:w.yunet_score_threshold,onChange:e=>k(a=>({...a,yunet_score_threshold:e.target.value}))}),(0,a.jsx)("p",{className:"text-[11px] text-muted-foreground",children:e("adminConfig.defaults.value","Default: {value}",{value:v.defaults.face_engine?.yunet_score_threshold??"—"})})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)(u.Label,{className:"text-xs font-semibold",children:e("adminConfig.fields.nmsThreshold","Ambang NMS YuNet")}),(0,a.jsx)(c.Input,{value:w.yunet_nms_threshold,onChange:e=>k(a=>({...a,yunet_nms_threshold:e.target.value}))}),(0,a.jsx)("p",{className:"text-[11px] text-muted-foreground",children:e("adminConfig.defaults.value","Default: {value}",{value:v.defaults.face_engine?.yunet_nms_threshold??"—"})})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)(u.Label,{className:"text-xs font-semibold",children:e("adminConfig.fields.topK","YuNet Top K")}),(0,a.jsx)(c.Input,{value:w.yunet_top_k,onChange:e=>k(a=>({...a,yunet_top_k:e.target.value}))}),(0,a.jsx)("p",{className:"text-[11px] text-muted-foreground",children:e("adminConfig.defaults.value","Default: {value}",{value:v.defaults.face_engine?.yunet_top_k??"—"})})]}),(0,a.jsx)("div",{className:"sm:col-span-2",children:(0,a.jsx)(o.Button,{type:"submit",disabled:N,children:e("adminConfig.actions.saveFace","Simpan Face Engine")})})]})})]}),!v.loading&&(0,a.jsxs)(d.Card,{children:[(0,a.jsx)(d.CardHeader,{children:(0,a.jsx)(d.CardTitle,{children:e("adminConfig.sections.attendance.title","Absensi")})}),(0,a.jsx)(m.Separator,{}),(0,a.jsx)(d.CardContent,{className:"p-6",children:(0,a.jsxs)("form",{className:"grid gap-4 sm:grid-cols-2",onSubmit:e=>{e.preventDefault(),I("attendance")},children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)(u.Label,{className:"text-xs font-semibold",children:e("adminConfig.fields.cooldownSec","Cooldown")}),(0,a.jsx)(c.Input,{value:D.cooldown_str,onChange:e=>A(a=>({...a,cooldown_str:e.target.value})),placeholder:e("adminConfig.help.wsInterval","mm:ss atau detik")}),(0,a.jsx)("p",{className:"text-[11px] text-muted-foreground",children:e("adminConfig.defaults.value","Default: {value}",{value:v.defaults.attendance?.cooldown_sec??"—"})})]}),(0,a.jsx)("div",{className:"sm:col-span-2",children:(0,a.jsx)(o.Button,{type:"submit",disabled:N,children:e("adminConfig.actions.saveAttendance","Simpan Absensi")})})]})})]}),(0,a.jsx)(g.Dialog,{open:j.open,onOpenChange:e=>{e?C(e=>({...e,open:!0})):C(e=>({...e,open:!1}))},children:(0,a.jsxs)(g.DialogContent,{hideOverlay:!0,className:"max-w-3xl bg-background",onEscapeKeyDown:()=>C(e=>({...e,open:!1})),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),C(e=>({...e,open:!1})))},children:[(0,a.jsxs)(g.DialogHeader,{children:[(0,a.jsx)(g.DialogTitle,{children:j.title}),(0,a.jsx)(g.DialogDescription,{children:e("adminConfig.json.hint","Dump data mentah untuk debugging")})]}),(0,a.jsx)("div",{className:"max-h-[60vh] overflow-auto rounded-md bg-muted p-4",children:(0,a.jsx)("pre",{className:"text-xs leading-relaxed",children:j.content})})]})})]},p)}e.s(["default",()=>p])}]);